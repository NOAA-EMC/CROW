
vrfy_base: &vrfy_base !Action
  <<: *action_base
  Template: !Template
    <<: [ *CYC_TRACK_VARS, *CYC_GEN_VARS, *MIN_VARS, *RAD_VARS, *OZN_VARS, *MIN_RAD_OZN_VARS, *VRFY_CDUMP_GFS_VARS, *vrfy_template ]
  J_JOB: vrfy
  walltime: !timedelta 01:00:00
  resources: !calc run_vrfy.resources
  memory: "3072M"

  CASE_ENKF: !calc doc.fv3_enkf_settings.CASE
  CDFNL: "gdas"
  CDUMPFCST: "gdas"  # Fit-to-obs with GDAS/GFS prepbufr
  GRIB1_WORKS: NO
  SMOOTH_ENKF: YES
  BACKDATEVSDB: !FirstTrue
    - when: !calc CDUMP=="gfs"
      do: 24
    - otherwise: null
  VBACKUP_PRCP: !FirstTrue
    - when: !calc CDUMP=="gfs"
      do: 24
    - otherwise: null
  VSDBSH: !FirstTrue
    - when: !calc CDUMP=="gfs"
      do: !calc doc.places.VSDBSH
    - otherwise: null
  ftyplist: !FirstTrue
    - when: !calc CDUMP=="gfs"
      do: "pgbq"
    - otherwise: null
  vhr_rain: !FirstTrue
    - when: !calc CDUMP=="gfs"
      do: 240
    - otherwise: null
  vlength: !FirstTrue
    - when: !calc CDUMP=="gfs"
      do: 240
    - otherwise: null
  vsdbhome: !FirstTrue
    - when: !calc CDUMP=="gfs"
      do: !calc doc.places.vsdbhome
    - otherwise: null
  vsdbsave: !FirstTrue
    - when: !calc CDUMP=="gfs"
      do: !calc doc.places.vsdbsave
    - otherwise: null
  VDUMP: "gfs"
  VRFYG2OBS: NO
  VRFYGENESIS: NO
  VRFYGMPK: NO
  VRFYMINMON: NO
  VRFYOZN: NO
  VRFYPRCP: YES
  VRFYRAD: NO
  VRFYTRAK: NO
  VSDB_STEP1: YES
  VSDB_STEP2: NO
  VRFYGENESIS: YES     # Cyclone genesis
  VRFYGMPK: NO         # Gempak verification
  WRITE_NEMSIOFILE: YES
  assim_freq: 6
  memory_vrfy: "16384M"
  nst_anl: YES

vrfy_gfs_action: &vrfy_gfs_action !Action
  <<: [ *fv3_gfs_settings, *data_assimilation, *vrfy_base ]
  CDUMP: gfs
  CASE: !calc doc.fv3_gfs_settings.CASE
  Inherit: !Inherit
    - [ doc.gfs_output_settings, "^FH.*|OUTPUT_GRID" ]
    - [ doc.platform.general_env, ".*" ]
    - [ doc.platform.mpi_tuning, ".*" ]
    - [ doc.fv3_settings, "LEVS|QUILTING|WRITE_NEMSIOFILE|nst_anl" ]
    - [ doc.case, "EDATE|SDATE|gfs_cyc|DO_RELOCATE|DO_MAKEPREPBUFR" ]

vrfy_gdas_action: &vrfy_gdas_action !Action
  <<: [ *fv3_gdas_settings, *data_assimilation, *vrfy_base ]
  CDUMP: gdas
  CASE: !calc doc.fv3_gdas_settings.CASE
  Inherit: !Inherit
    - [ doc.gfs_output_settings, "^FH.*|OUTPUT_GRID" ]
    - [ doc.platform.general_env, ".*" ]
    - [ doc.platform.mpi_tuning, ".*" ]
    - [ doc.fv3_settings, "LEVS|QUILTING|WRITE_NEMSIOFILE|nst_anl" ]
    - [ doc.case, "EDATE|SDATE|gfs_cyc|DO_RELOCATE|DO_MAKEPREPBUFR" ]

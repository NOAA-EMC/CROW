

action_template: &action_template
  <<: [ *resource_defaults, *case ] 
  Template: *fv3_resolution
  ACCOUNT: !calc doc.case.cpu_project
  DONST: NO
  HPSS_PROJECT: !calc doc.case.hpss_project
  KEEPDATA: NO
  PSLOT: !calc doc.case.experiment_name
  QUEUE: !calc doc.platform.queue
  QUEUE_ARCH: !calc doc.platform.queue_arch
  BASE_NEMSfv3gfs: !calc doc.case.BASE_NEMSfv3gfs
  CASE: !calc doc.case.CASE
  BASE_GSI: !calc doc.case.BASE_GSI
  BASE_GSM: !calc doc.case.BASE_GSM
  shell_vars: [ "[A-Z][A-Z0-9_]*$", 'APRUN*' ]

  APRUN_TEST_VAR: I am here











arch: &arch_action !Action
  <<: *action_template
  J_JOB: arch
  walltime: !timedelta 06:00:00
  resources: !calc run_arch.resources
  memory: "3072M"
  accounting: !calc doc.platform.transfer_accounting

vrfy: &vrfy_action !Action
  <<: [ *case, *action_template ]
  J_JOB: vrfy
  Template:
    <<: [ *vrfy_template, *fv3_resolution ]
  walltime: !timedelta 01:00:00
  resources: !calc run_vrfy.resources
  memory: "3072M"
  accounting: !calc doc.platform.parallel_accounting
#  CDUMP: "gfs"
  ATARDIR: "/NCEPDEV/emc-global/1year/Samuel.Trahan/THEIA/scratch/wham"
  BASE_ENV: !calc doc.places.BASE_ENV
  BASE_GSI: !calc doc.places.BASE_GSI
  BASE_JOB: !calc doc.places.BASE_JOB
  BASE_NEMSfv3gfs: !calc doc.places.BASE_NEMSfv3gfs
  BASE_POST: !calc doc.places.BASE_POST
  BASE_PREP: !calc doc.places.BASE_PREP
  BASE_PREP_GLOBAL: !calc doc.places.BASE_PREP_GLOBAL
  BASE_SVN: !calc doc.places.BASE_SVN
  BASE_VERIF: !calc doc.places.BASE_VERIF
  CASE: !calc doc.case.CASE
  CASE_ENKF: !calc doc.case.CASE_ENKF
  CHGRP_CMD: "'chgrp rstprod'"
  CDFNL: "gdas"
  CDUMPFCST: "gdas"  # Fit-to-obs with GDAS/GFS prepbufr
  CNVGRIB: !calc doc.places.CNVGRIB
  COPYGB: !calc doc.places.COPYGB
  COPYGB2: !calc doc.places.COPYGB2
  DOHYBVAR: !calc doc.case.DOHYBVAR
  DONST: NO
  EDATE: !calc doc.case.EDATE
  FHCYC: !calc doc.case.FHCYC
  FHMAX: !calc doc.case.FHMAX
  FHMAX_ENKF: !calc doc.case.FHMAX_ENKF
  FHMAX_GFS: !calc doc.case.FHMAX_GFS
  FHMAX_HF_GFS: !calc doc.case.FHMAX_HF_GFS
  FHMIN: !calc doc.case.FHMIN
  FHMIN_ENKF: !calc doc.case.FHMIN_ENKF
  FHMIN_GFS: !calc doc.case.FHMIN_GFS
  FHOUT: !calc doc.case.FHOUT
  FHOUT_ENKF: !calc doc.case.FHOUT_ENKF
  FHOUT_GFS: !calc doc.case.FHOUT_GFS
  FHOUT_HF_GFS: !calc doc.case.FHOUT_HF_GFS
  GRB2INDEX: !calc doc.platform.GRB2INDEX
  GRBINDEX: !calc doc.platform.GRBINDEX
  GRBINDEX2: !calc doc.platform.GRBINDEX2
  GRIB1_WORKS: NO
  HOMEDIR: !calc doc.case.HOMEDIR
  LEVS: !calc doc.case.LEVS
  KEEPDATA: NO
  MPI_BUFS_PER_HOST: !calc doc.platform.MPI_BUFS_PER_HOST
  MPI_BUFS_PER_PROC: !calc doc.platform.MPI_BUFS_PER_PROC
  MPI_GROUP_MAX: !calc doc.platform.MPI_GROUP_MAX
  MPI_MEMMAP_OFF: !calc doc.platform.MPI_MEMMAP_OFF
  MP_STDOUTMODE: !calc doc.platform.MP_STDOUTMODE
  MYBASE_SVN: !calc doc.places.MYBASE_SVN
  NCO_NAMING_CONV: !calc doc.platform.NCO_NAMING_CONV
  NCP: !calc doc.platform.NCP
  NLN: !calc doc.platform.NLN
  NMEM_ENKF: !calc doc.case.NMEM_ENKF
  NMV: !calc doc.platform.NMV
  NOSCRUB: !calc doc.case.NOSCRUB
  NTHSTACK: 1024000000
  OMP_STACKSIZE: !calc doc.platform.OMP_STACKSIZE
  OUTPUT_GRID: "gaussian_grid"
  POSTJJOBSH: !expand "{doc.case.BASE_WORKFLOW}/jobs/JGFS_POST.sh"
  PSLOT: !calc doc.places.PSLOT
  PTMP: !calc doc.places.PTMP
  QUILTING: YES
  REALTIME: !calc doc.case.REALTIME
  RECENTER_ENKF: !calc doc.case.RECENTER_ENKF
  ROTDIR: !calc doc.places.ROTDIR
  RUNDIR: !calc doc.places.RUNDIR
  SDATE: !calc doc.case.SDATE
  SMOOTH_ENKF: YES
  STMP: !calc doc.places.STMP
  VERBOSE: YES
  VRFYGENESIS: YES     # Cyclone genesis
  VRFYGMPK: NO         # Gempak verification
  WRITE_NEMSIOFILE: YES
  assim_freq: 6
  memory_vrfy: "16384M"
  nst_anl: YES
  WRITE_NEMSIOFILE: YES
